<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <script src="node_modules/cytoscape/dist/cytoscape.min.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <title>Title</title>
    <style>
        #grafInput
        {
            width: 500px;
            height: 350px;
            display: block;
            background-color: white;
            border: black solid thin;
            float: left;
        }
        body
        {
            background-color: #bbbbbb;
        }
    </style>

    <script>

        var macierzSasiedztw;
        function onLoad()
        {
            document.getElementById("nodesButtonSucces").hidden = true;
        }

        //Dodaje pola wyboru sąsiadów wierzchołków
        function addFields()
        {
            var number = document.getElementById("nodesNumber").value;
            var container = document.getElementById("nodesInput");
            while (container.hasChildNodes())
            {
                container.removeChild(container.lastChild);
            }

            for (i = 0; i < number; i++)
            {
                container.appendChild(document.createTextNode("Wierzchołek " + (i+1) + " "));
                var input = document.createElement("input");
                input.type = "text";
                input.name = "node" + (i+1);
                input.id = "nodeID" + (i+1);
                container.appendChild(input);
                container.appendChild(document.createElement("br"));
            }
            if (number > 0)
                document.getElementById("nodesButtonSucces").hidden = false;
            else
                document.getElementById("nodesButtonSucces").hidden = true;
        }

    </script>
    </head>
<body onload="onLoad()">
    <div id="container">
        <center><h1>Projekt na Grafy i Sieci</h1></center>
    </hr>
        <div class="col-6 .col-lg-4" style="float: left">
            <div class="col-6 .col-md-4" style="float: left; text-align: justify">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec finibus massa sed tortor tincidunt, in rhoncus diam aliquam. Pellentesque rhoncus nunc id diam dictum, sed maximus augue porttitor. Morbi imperdiet leo ut suscipit imperdiet. Quisque fermentum viverra lectus tempor ornare. Etiam vel condimentum lacus. Aliquam non dapibus libero. Suspendisse nec pulvinar elit. Quisque justo nunc, finibus sed egestas vel, tempor et tellus. Donec aliquet ex varius urna rhoncus euismod.</div>
            <div class="col-6 .col-md-4" style="float: left; text-align: center">
                <div class="form-group">
                    <label for="sel1">Wybierz typ grafu:</label>
                    <select class="form-control" id="sel1">
                        <option value="0">Skierowany</option>
                        <option value="1">Nieskierowany</option>
                    </select>
                    <BR>
                    Podaj liczbę wierchołków:
                    <input type="number" id="nodesNumber" style="max-width: 40px"/>
                    <div><button type="button" class="btn btn-success" id="graphButtonSuccess" onclick="addFields()">Wybierz</button></div>
                    <BR>
                    <div id="nodesInput">

                    </div>
                    <BR>
                    <button type="button" class="btn btn-success" id="nodesButtonSucces" onclick="LoadGraph()">Zatwierdź</button>
                </div>


            </div>
        </div>
        <div class="col-sm-6 .col-lg-8" style="float: left">
            <div id="grafInput"></div>
        </div>
    </div>

<script>

    //uzupełnia macierz sąsiedztw. Do tego generuje graf graficznie
    function LoadGraph()
    {
        macierzSasiedztw = [];
        var number = document.getElementById("nodesNumber").value;
        for (k = 0; k < number; k++)
        {
            macierzSasiedztw.push(Array());
        }

        for (i = 0; i < number; i++)
        {
            for (j = 0; j < number; j++)
            {
                macierzSasiedztw[i][j] = 0;
            }
        }

        for (i = 0; i < number; i++)
        {
            var id = "nodeID" + (i+1);
            var inputNode = document.getElementById(id);
            var value = inputNode.value;
            var table = value.split(",");
            for (j = 0; j < table.length; j++)
            {
                if (table[j]!=0)
                    macierzSasiedztw[i][table[j] - 1] = 1;
            }

            console.log(macierzSasiedztw);
        }

        // 0 - skierowany, 1 - nieskierowany
        var type = document.getElementById("sel1").value;

        if (type == 0)
            rysujGrafSkierowany();
        else
            rysujGrafNieskierowany();
    }

    function rysujGrafNieskierowany()
    {
        var cy = cytoscape({
            container: document.getElementById('grafInput')
        });

        for (i = 0; i < macierzSasiedztw.length; i++)
        {
            cy.add({
                group: 'nodes',
                data: {id: 'n'+i},
                position: {x: 200, y: 200 },
                style: {label: i+1},
            });
        }

        for (i = 0; i < macierzSasiedztw.length; i++)
        {
            for (j = 0; j < macierzSasiedztw.length; j++)
            {
                if (macierzSasiedztw[i][j] == 1)
                {
                    cy.add({
                        group: 'edges',
                        data: {
                            id: 'e'+i+j,
                            source:'n'+i,
                            target:'n'+j
                        }
                    });
                }
            }
        }
    }

    function rysujGrafSkierowany()
    {
        var cy = cytoscape({
            container: document.getElementById('grafInput'),
            style: [{
                    selector: "edge[arrow]",
                    style:
                        {
                            "target-arrow-shape": "triangle"
                        }
                }
            ],
        });

        for (i = 0; i < macierzSasiedztw.length; i++)
        {
            cy.add({
                group: 'nodes',
                data: {id: 'n'+i},
                position: {x: 200, y: 200 },
                style: {label: i+1},
            });
        }

        for (i = 0; i < macierzSasiedztw.length; i++)
        {
            for (j = 0; j < macierzSasiedztw.length; j++)
            {
                if (macierzSasiedztw[i][j] == 1)
                {
                    cy.add({
                        group: 'edges',
                        data: {
                            id: 'e'+i+j,
                            source:'n'+i,
                            target:'n'+j, },
                    });
                }
            }
        }
    }

</script>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
</body>
</html>